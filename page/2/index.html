<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="一个不愿透露姓名的网友的博客">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="一个不愿透露姓名的网友的博客">
<meta property="og:locale">
<meta property="article:author" content="无敌 .2.0">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>一个不愿透露姓名的网友的博客</title>
  








<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">一个不愿透露姓名的网友的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">真香</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/13/DMA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个不愿透露姓名的网友的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/13/DMA/" itemprop="url">DMA(直接存储器访问)方式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-13T17:31:29+08:00">
                2020-05-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DMA占用内存时CPU不可占用</span><br><span class="line">目录：</span><br><span class="line">1.DMA方式特点</span><br><span class="line">2.DMA接口的功能和组成</span><br><span class="line">3.DMA的工作过程</span><br><span class="line">4.DMA接口的类型</span><br></pre></td></tr></table></figure>
<h2 id="1-DMA方式特点"><a href="#1-DMA方式特点" class="headerlink" title="1.DMA方式特点"></a>1.DMA方式特点</h2><h3 id="1-DMA和程序中断两种方式的数据通路"><a href="#1-DMA和程序中断两种方式的数据通路" class="headerlink" title="1.DMA和程序中断两种方式的数据通路"></a>1.DMA和程序中断两种方式的数据通路</h3><p><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/78.png" alt="78"><br>可跳过CPU节省CPU。把CPU冲数据交换中解放出来</p>
<h3 id="2-DMA与主存交换数据的三种方式"><a href="#2-DMA与主存交换数据的三种方式" class="headerlink" title="2.DMA与主存交换数据的三种方式"></a>2.DMA与主存交换数据的三种方式</h3><h4 id="1-停止CPU访问主存"><a href="#1-停止CPU访问主存" class="headerlink" title="1.停止CPU访问主存"></a>1.停止CPU访问主存</h4><ol>
<li>控制简单</li>
<li>CPU处于不工作状态或者维持现状</li>
<li>为充分发挥CPU对主存的利用率<h4 id="2-周期挪用（窃取）"><a href="#2-周期挪用（窃取）" class="headerlink" title="2.周期挪用（窃取）"></a>2.周期挪用（窃取）</h4></li>
<li>CPU访问时，DMA不可占用</li>
<li>CPU未访问时，DMA可占用</li>
<li>CPU和DMA同时申请时，占用分配给DMA（DMA连接都是高速I/O设备，不响应可能造成数据流失）<h4 id="3-DMA-CPU交替使用"><a href="#3-DMA-CPU交替使用" class="headerlink" title="3.DMA,CPU交替使用"></a>3.DMA,CPU交替使用</h4>CPU工作周期C1，C2<br>C1分配给CPU<br>C2分配给DMA<h2 id="2-DMA接口的功能和组成"><a href="#2-DMA接口的功能和组成" class="headerlink" title="2.DMA接口的功能和组成"></a>2.DMA接口的功能和组成</h2><h3 id="1-DMA接口的功能"><a href="#1-DMA接口的功能" class="headerlink" title="1.DMA接口的功能"></a>1.DMA接口的功能</h3></li>
<li>向CPU申请DMA传送</li>
<li>处理总线控制权的转交</li>
<li>管理系统总线，控制数据传送</li>
<li>确定数据传送的首地址和长度，修改传送过程中的地址和长度</li>
<li>DMA传送结束，给出操作完成的信号<h3 id="2-DMA接口的组成"><a href="#2-DMA接口的组成" class="headerlink" title="2.DMA接口的组成"></a>2.DMA接口的组成</h3>AR（地址寄存器）：得知传输地址<br>WC（计数器）：得知传输计数量（字数）<br>BR（数据缓冲器）：外部数据缓存<br>DAR（设备地址寄存器）：1.设备选择电路是使用，将设备地址保存。 2.对硬盘访问时，保存访问地址信息。<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/84.png" alt="84"><br>DREQ:device request设备请求<br>DACK:device acknoledge设备应答<br>设备对DMA设备逻辑控制发出DREQ，DMA设备逻辑控制对设备发出DACK。<br>DMA对总线发出使用信号（HRQ）。<br>总线对DMA发出应答信号（HLDA）。<h2 id="3-DMA的工作过程"><a href="#3-DMA的工作过程" class="headerlink" title="3.DMA的工作过程"></a>3.DMA的工作过程</h2><h3 id="1-DMA传送过程"><a href="#1-DMA传送过程" class="headerlink" title="1.DMA传送过程"></a>1.DMA传送过程</h3></li>
<li>预处理</li>
<li>数据传送</li>
<li>后处理<h4 id="1-预处理"><a href="#1-预处理" class="headerlink" title="1.预处理"></a>1.预处理</h4></li>
<li>通知DMA控制逻辑的传送方向（输入输出）</li>
<li>设备地址——&gt; DMA（DAR）</li>
<li>主存地址——&gt; DMA（AR）</li>
<li>传送字数——&gt; DMA（WC）<h4 id="2-数据传送"><a href="#2-数据传送" class="headerlink" title="2.数据传送"></a>2.数据传送</h4><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/79.png" alt="79"><br>输入<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/80.png" alt="80"><br>输出<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/81.png" alt="81"><h4 id="3-后处理"><a href="#3-后处理" class="headerlink" title="3.后处理"></a>3.后处理</h4><strong>由中断服务程序完成</strong></li>
<li>校验送入主存的数据是否正确</li>
<li>是否继续使用DMA</li>
<li>检验传送过程是否正确，错则转诊断程序<h3 id="2-DMA接口和系统的连接方式"><a href="#2-DMA接口和系统的连接方式" class="headerlink" title="2.DMA接口和系统的连接方式"></a>2.DMA接口和系统的连接方式</h3></li>
<li>具有公共请求线的DMA请求</li>
<li>独立DMA请求<h3 id="3-DAM方式和程序中断方式的比较"><a href="#3-DAM方式和程序中断方式的比较" class="headerlink" title="3.DAM方式和程序中断方式的比较"></a>3.DAM方式和程序中断方式的比较</h3><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/82.png" alt="82"><h2 id="4-DMA接口的类型"><a href="#4-DMA接口的类型" class="headerlink" title="4.DMA接口的类型"></a>4.DMA接口的类型</h2><code>1.选择型
2.多路型</code><h3 id="1-选择性"><a href="#1-选择性" class="headerlink" title="1.选择性"></a>1.选择性</h3><strong>物理上连接多个设备，逻辑上连接一个设备</strong><br>传送过程中只能又一个设备使用接口。<h3 id="2-多路型"><a href="#2-多路型" class="headerlink" title="2.多路型"></a>2.多路型</h3><strong>物理上连接多个设备，逻辑上连接多个设备</strong><br>传送过程中只有一个设备与传输，但是可以有多个设备同时进行数据准备<h3 id="3-多路型DMA接口的工作原理"><a href="#3-多路型DMA接口的工作原理" class="headerlink" title="3.多路型DMA接口的工作原理"></a>3.多路型DMA接口的工作原理</h3><strong>速度越高优先级越高</strong><br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/83.png" alt="83"></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/05/04/3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个不愿透露姓名的网友的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/04/3/" itemprop="url">主存储器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-04T17:35:30+08:00">
                2020-05-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="2-半导体存储芯片简介"><a href="#2-半导体存储芯片简介" class="headerlink" title="2.半导体存储芯片简介"></a>2.半导体存储芯片简介</h2><h3 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h3><h4 id="地址线-数据线"><a href="#地址线-数据线" class="headerlink" title="地址线+数据线"></a>地址线+数据线</h4><p><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/72.png" alt=""></p>
<h4 id="片选线"><a href="#片选线" class="headerlink" title="片选线"></a>片选线</h4><p><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/73.png" alt=""></p>
<ul>
<li>作用<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/74.png" alt=""><h3 id="译码方式"><a href="#译码方式" class="headerlink" title="译码方式"></a>译码方式</h3><h4 id="线选法"><a href="#线选法" class="headerlink" title="线选法"></a>线选法</h4><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/75.png" alt=""><br>所选中线工作其他不工作，线的排布很密集。<br>对容量大的芯片不合适。<h4 id="重合法"><a href="#重合法" class="headerlink" title="重合法"></a>重合法</h4>行列坐标<br>适用存储矩阵<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4>假设20根地址线<br>线选法：溢出1m条<br>重合法则是：溢出2k条<h2 id="3-随机存取储存器（RAM）"><a href="#3-随机存取储存器（RAM）" class="headerlink" title="3.随机存取储存器（RAM）"></a>3.随机存取储存器（RAM）</h2><h3 id="1-静态RAM（SRAM）"><a href="#1-静态RAM（SRAM）" class="headerlink" title="1.静态RAM（SRAM）"></a>1.静态RAM（SRAM）</h3><h3 id="2-动态RAM（DRAM）"><a href="#2-动态RAM（DRAM）" class="headerlink" title="2.动态RAM（DRAM）"></a>2.动态RAM（DRAM）</h3>读操作时：<br>预信号充电T4充电，VDD通过T4给读数据线充电。当选择读数据是读选择先被充电T2导通，如果，数据是1电容cg被充电，T1导通，数据线放电，此时数据线就是0.如果数据是0电容未充电，T1未导通，数据线不放电数据线读到的是<br>写操作：<br>如果写入的是1数据线通过T3向电容充电写入1，反之电容放电。<br>写入信息相同读出相反。<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/76.png" alt=""><h3 id="动态RAM刷新"><a href="#动态RAM刷新" class="headerlink" title="动态RAM刷新"></a>动态RAM刷新</h3><strong>刷新与行地址有关</strong><h4 id="集中刷新"><a href="#集中刷新" class="headerlink" title="集中刷新"></a>集中刷新</h4><ul>
<li>集中式刷新</li>
</ul>
</li>
<li>集中在某一时间内刷新<ul>
<li>有死区<h4 id="分散刷新"><a href="#分散刷新" class="headerlink" title="分散刷新"></a>分散刷新</h4>写入后刷新</li>
<li>增长读写周期</li>
<li>芯片性能下降</li>
<li>刷新太频繁<h4 id="异步刷新（分散和集中结合）"><a href="#异步刷新（分散和集中结合）" class="headerlink" title="异步刷新（分散和集中结合）"></a>异步刷新（分散和集中结合）</h4></li>
<li>每隔一段时间刷新一行</li>
<li>刷新安排在译码阶段，不会产生死区<h3 id="3-对比"><a href="#3-对比" class="headerlink" title="3.对比"></a>3.对比</h3>1.<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/77.png" alt=""><h2 id="4-只读存储器（ROM）"><a href="#4-只读存储器（ROM）" class="headerlink" title="4.只读存储器（ROM）"></a>4.只读存储器（ROM）</h2></li>
<li>PROM一次性编程（采用熔丝）</li>
<li>EPROM多次性编程（紫外线全部擦除）</li>
<li>EEPROM多次性编程（多次擦除，局部擦出，电可擦写）</li>
<li>Flash Memory（闪速型存储器（U盘））<h2 id="5-存储器与CPU连接"><a href="#5-存储器与CPU连接" class="headerlink" title="5.存储器与CPU连接"></a>5.存储器与CPU连接</h2><h3 id="1-存储器容量扩展"><a href="#1-存储器容量扩展" class="headerlink" title="1.存储器容量扩展"></a>1.存储器容量扩展</h3><h4 id="1-位扩展（增加存储字字长）"><a href="#1-位扩展（增加存储字字长）" class="headerlink" title="1.位扩展（增加存储字字长）"></a>1.位扩展（增加存储字字长）</h4>用<strong>两个</strong>1k <em> 4位的存储器构成一个1K </em> 8位的存储器<h4 id="2-字扩展（增加储存字的数量）"><a href="#2-字扩展（增加储存字的数量）" class="headerlink" title="2.字扩展（增加储存字的数量）"></a>2.字扩展（增加储存字的数量）</h4><strong>两个</strong>1K <em> 8位的芯片组成一个2K </em> 8 位的存储器<h4 id="3-同时扩展"><a href="#3-同时扩展" class="headerlink" title="3.同时扩展"></a>3.同时扩展</h4><strong>八个</strong>1K <em> 4 位组成一个4K </em> 8位的存储器<h3 id="2-存储器与CPU连接"><a href="#2-存储器与CPU连接" class="headerlink" title="2.存储器与CPU连接"></a>2.存储器与CPU连接</h3><h4 id="1-地址线的连接"><a href="#1-地址线的连接" class="headerlink" title="1.地址线的连接"></a>1.地址线的连接</h4><h4 id="2-数据线的连接"><a href="#2-数据线的连接" class="headerlink" title="2.数据线的连接"></a>2.数据线的连接</h4><h4 id="3-读-写命令线连接"><a href="#3-读-写命令线连接" class="headerlink" title="3.读/写命令线连接"></a>3.读/写命令线连接</h4><h4 id="4-片选线的连接"><a href="#4-片选线的连接" class="headerlink" title="4.片选线的连接"></a>4.片选线的连接</h4><h4 id="5-合理选择存储芯片"><a href="#5-合理选择存储芯片" class="headerlink" title="5.合理选择存储芯片"></a>5.合理选择存储芯片</h4><h4 id="5-其他-时序、负载"><a href="#5-其他-时序、负载" class="headerlink" title="5.其他  时序、负载"></a>5.其他  时序、负载</h4><h2 id="6-存储器的校验"><a href="#6-存储器的校验" class="headerlink" title="6.存储器的校验"></a>6.存储器的校验</h2></li>
<li>受各种因素影响，容易出错。</li>
</ul>
</li>
</ul>
<p><strong>编码最小距离：任意两组编码之间二进制数最少差异</strong></p>
<ul>
<li>编码的纠错和检错能力和编码最小距离有关。</li>
<li>L-1=D+C（D&gt;=C）<ul>
<li>L 最小编码距离</li>
<li>D 检测错误的位数</li>
<li>C 纠错错误的位数<h4 id="汉明码组成"><a href="#汉明码组成" class="headerlink" title="汉明码组成"></a>汉明码组成</h4><h5 id="添加检测位位数"><a href="#添加检测位位数" class="headerlink" title="添加检测位位数"></a>添加检测位位数</h5>2^k&gt;=n+k+1<br>添加k位，分为k组<h5 id="检测位位置"><a href="#检测位位置" class="headerlink" title="检测位位置"></a>检测位位置</h5>2^i（i=0,1,2,3……）（第1,2,3……组）<br>检测数据（二进制第i位位1的数） </li>
<li>C1 检测（1,3,5,7,9……）</li>
<li>第i小组独占第i位，同理第i，j小组独占第i，j位（二进制）<h4 id="汉明码的纠错过程"><a href="#汉明码的纠错过程" class="headerlink" title="汉明码的纠错过程"></a>汉明码的纠错过程</h4></li>
</ul>
</li>
<li>形成新的检测为，其位数与增添的检测为有关<h5 id="检测位取值"><a href="#检测位取值" class="headerlink" title="检测位取值"></a>检测位取值</h5><h2 id="7-提高访存速度的措施"><a href="#7-提高访存速度的措施" class="headerlink" title="7.提高访存速度的措施"></a>7.提高访存速度的措施</h2></li>
<li>采用高速器件</li>
<li>采用cache-主存模式</li>
<li>调整主存结构<h3 id="调整主存结构"><a href="#调整主存结构" class="headerlink" title="调整主存结构"></a>调整主存结构</h3><h4 id="1-单体多字"><a href="#1-单体多字" class="headerlink" title="1.单体多字"></a>1.单体多字</h4></li>
</ul>
<ol>
<li><strong>cpu为16位，内存为64位。cpu一次访问可读取4个机器字（cpu一次读取一组）</strong><br><strong>缺点：</strong> 1. 写入时，如果只写入16位则会有48位被修改。<br>2.取四条指令，如果第一条是跳转指令，而且跳出了后面三个字范围则只有一条指令有效。<h4 id="2-多体运行"><a href="#2-多体运行" class="headerlink" title="2.多体运行"></a>2.多体运行</h4><h5 id="1-高位交叉-顺序编址"><a href="#1-高位交叉-顺序编址" class="headerlink" title="1.高位交叉 顺序编址"></a>1.高位交叉 顺序编址</h5>将内存分为几个存储体。高位为存储体编号，后几位为存储体内编号。将多个存储体独立。<br><strong>地址：|体号|体内地址|</strong><br><strong>缺点：</strong> 可能造成某一存储体很繁忙。（程序执行是顺序存放地址）<h5 id="2-低位交叉-各个体轮流编址"><a href="#2-低位交叉-各个体轮流编址" class="headerlink" title="2.低位交叉 各个体轮流编址"></a>2.低位交叉 各个体轮流编址</h5>低位位体号。<br><strong>地址：|体内地址|体号|</strong><br>特点：不改变存取周期情况下，增加带宽。<h4 id="3-高性能存储芯片"><a href="#3-高性能存储芯片" class="headerlink" title="3.高性能存储芯片"></a>3.高性能存储芯片</h4></li>
</ol>
<ul>
<li>SDRAM（同步DRAM）<ul>
<li>cpu无序等待</li>
</ul>
</li>
<li>RDRAM<ul>
<li>解决存储宽带问题</li>
</ul>
</li>
<li>带cache的DRAM<ul>
<li>有利于猝发式读取</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/22/2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个不愿透露姓名的网友的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/22/2/" itemprop="url">存储器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-04-22T17:23:54+08:00">
                2020-04-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><h3 id="1-存储器分类"><a href="#1-存储器分类" class="headerlink" title="1.存储器分类"></a>1.存储器分类</h3><h4 id="1-按照介质分类"><a href="#1-按照介质分类" class="headerlink" title="1.按照介质分类"></a>1.按照介质分类</h4><ol>
<li>半导体存储器（TTL，MOS）</li>
<li>磁表面存储器（磁头，载磁体）</li>
<li>磁性存储器（硬磁材料，环装原件）</li>
<li>光盘存储器（激光，激光材料）<h4 id="2-按照存取方式分类"><a href="#2-按照存取方式分类" class="headerlink" title="2.按照存取方式分类"></a>2.按照存取方式分类</h4></li>
<li>存取时间与物理地址无关（随机访问）<ul>
<li>随机存储器（可读可写）</li>
<li>只读存储器（只可读）</li>
</ul>
</li>
<li>存取时间与物理地址有关（串行访问）<ul>
<li>顺序存取存储器（磁带）</li>
<li>直接存取存储器（磁盘）</li>
</ul>
</li>
<li>按在计算机中的作用<ul>
<li>主存储器<ul>
<li>RAM（随机存储器）<ul>
<li>静态 RAM</li>
<li>动态 RAM</li>
</ul>
</li>
<li>ROM（只读存储器）<ul>
<li>MROM</li>
<li>PROM</li>
<li>EPROM</li>
<li>EEPROM</li>
</ul>
</li>
</ul>
</li>
<li>flash Momery（比磁盘快，比主存储器慢）（比如：U盘）<ul>
<li>可作为硬盘</li>
<li>可作为辅助存储器缓冲</li>
</ul>
</li>
<li>辅助存储器<ul>
<li>磁盘、磁带、光盘等</li>
</ul>
</li>
<li>高速缓冲存储器（cache）<ul>
<li>可作为cpu与主存之间的缓冲区（比主存快） <h3 id="2-存储器层次结构"><a href="#2-存储器层次结构" class="headerlink" title="2.存储器层次结构"></a>2.存储器层次结构</h3><h4 id="1-存储器三个主要特性关系"><a href="#1-存储器三个主要特性关系" class="headerlink" title="1.存储器三个主要特性关系"></a>1.存储器三个主要特性关系</h4><strong>单独一种存储器无法满足人们需求所以分为许多存储形成一个存储体</strong><br><img src="https://github.com/iamsnaping/picture/blob/master/57.png?raw=true" alt=""><h4 id="2-缓存-主存层次和储存-辅存层次"><a href="#2-缓存-主存层次和储存-辅存层次" class="headerlink" title="2.缓存-主存层次和储存-辅存层次"></a>2.缓存-主存层次和储存-辅存层次</h4><img src="https://github.com/iamsnaping/picture/blob/master/58.png?raw=true" alt=""><h2 id="主存储器"><a href="#主存储器" class="headerlink" title="主存储器"></a>主存储器</h2><h3 id="1-主存的基本组成"><a href="#1-主存的基本组成" class="headerlink" title="1.主存的基本组成"></a>1.主存的基本组成</h3><img src="https://github.com/iamsnaping/picture/blob/master/59.png?raw=true" alt=""><h3 id="2-主存与CPU之间的联系"><a href="#2-主存与CPU之间的联系" class="headerlink" title="2.主存与CPU之间的联系"></a>2.主存与CPU之间的联系</h3><img src="https://github.com/iamsnaping/picture/blob/master/60.png?raw=true" alt=""><h3 id="3-主存中储存单元地址的分配"><a href="#3-主存中储存单元地址的分配" class="headerlink" title="3.主存中储存单元地址的分配"></a>3.主存中储存单元地址的分配</h3><img src="https://github.com/iamsnaping/picture/blob/master/61.png?raw=true" alt=""><br>32位机1个字4字节16位则是2字节所以一个除4一个除2<br>W=word<h3 id="4-主存技术指标"><a href="#4-主存技术指标" class="headerlink" title="4.主存技术指标"></a>4.主存技术指标</h3></li>
</ul>
</li>
</ul>
</li>
<li>存储容量：主存 存放二进制代码的总位数</li>
<li>存储速度：<ul>
<li>存取时间<br>存储器的  1.读出时间   2.访问时间  3.写入时间</li>
<li>存取周期   <ul>
<li>两次连续的独立的存储器操作所需最小间隔周期 （一次开始到另一次开始）<ul>
<li>读操作 </li>
<li>写操作</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>存储带宽 单位：位/秒<h2 id="高速缓冲存储器（cache）"><a href="#高速缓冲存储器（cache）" class="headerlink" title="高速缓冲存储器（cache）"></a>高速缓冲存储器（cache）</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><h4 id="1-问题的提出"><a href="#1-问题的提出" class="headerlink" title="1.问题的提出"></a>1.问题的提出</h4></li>
</ol>
<ul>
<li>解决cpu空等问题 cpu与主存（DRAM）的速度差异</li>
<li>程序访问的局部性原理<ul>
<li>局部性原理是指CPU访问存储器时，无论是存取指令还是存取数据，所访问的存储单元都趋于聚集在一个较小的连续区域中。<h4 id="2-工作原理"><a href="#2-工作原理" class="headerlink" title="2.工作原理"></a>2.工作原理</h4></li>
</ul>
</li>
</ul>
<ol>
<li>主存与缓存的编址</li>
</ol>
<ul>
<li>cacha与主存之间数据交换单位为块</li>
<li>块中包块在使用的指令与数据与相邻的指令与数据</li>
<li>块分为：块内地址，块号</li>
<li>cacha还有一个标记用来记录主存的块的块号</li>
<li>块内地址（块内偏移地址）他的位数决定块的大小</li>
<li>主存块内地址与cacha中块内地址址相同。</li>
</ul>
<ol>
<li>命中与非命中<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/67.png" alt=""></li>
<li>cacha的命中率</li>
</ol>
<ul>
<li>cpu所需要的信息在cacha中比例</li>
<li>与块长与容量有关</li>
<li>一般4-8字</li>
<li>块长与一个存储周期中主存中取出信息长度</li>
</ul>
<ol>
<li>cache-主存系统效率<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/64.png" alt=""><h4 id="3-cache基本结构"><a href="#3-cache基本结构" class="headerlink" title="3.cache基本结构"></a>3.cache基本结构</h4><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/65.png" alt=""><br>映射结构：主存的块可放到cacha中哪个块<br>变换机构：主存中块在cacha中哪个块查找<br>替换机构：调用替换算法，哪个块冲cacha跳出<h4 id="4-cache的读写操作"><a href="#4-cache的读写操作" class="headerlink" title="4.cache的读写操作"></a>4.cache的读写操作</h4>读<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/66.png" alt=""><br>写<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/68.png" alt=""><br>优点<br>写直法：cache和主存内容一直一致<br>写回法：不会造成频繁的主存与cache的交互<br>缺点<br>写直法：可能会cpu对同一个单元的反复写，可能造成频繁的主存与cache的交互<br>学会法：保证不了cache与主存一直一致，多处理器有多个副本无法保证副本的一致性<h4 id="5-cache改进"><a href="#5-cache改进" class="headerlink" title="5.cache改进"></a>5.cache改进</h4></li>
</ol>
<ul>
<li>增加cache级数<ul>
<li>片载（片内）cache</li>
<li>片外cache</li>
</ul>
</li>
<li>统一缓存和分立缓存<ul>
<li>指令cache</li>
<li>数据cache<h3 id="cache主存地址映射"><a href="#cache主存地址映射" class="headerlink" title="cache主存地址映射"></a>cache主存地址映射</h3><h4 id="1-直接映射"><a href="#1-直接映射" class="headerlink" title="1.直接映射"></a>1.直接映射</h4></li>
</ul>
</li>
<li>cache利用效率可能很低，且容易发生冲突</li>
<li>每个缓存块i可以和多个主存块对应</li>
<li>每个主存块j只能和一个缓存块对应</li>
<li>i = j mod C</li>
<li>效率高<h4 id="2-全相联映射"><a href="#2-全相联映射" class="headerlink" title="2.全相联映射"></a>2.全相联映射</h4></li>
<li>每个内存块可以映射任意一个缓存块中</li>
<li>效率低</li>
<li>利用率高<h4 id="3-组相联映射"><a href="#3-组相联映射" class="headerlink" title="3.组相联映射"></a>3.组相联映射</h4></li>
<li>全相联映射和直接映射的折中</li>
<li>缓存中组数和主存中区数中的块数相同</li>
<li>某一主存块j按照模Q映射到i组中任意一块<h3 id="替换算法"><a href="#替换算法" class="headerlink" title="替换算法"></a>替换算法</h3><h4 id="1-先进先出算法（FIFO）"><a href="#1-先进先出算法（FIFO）" class="headerlink" title="1.先进先出算法（FIFO）"></a>1.先进先出算法（FIFO）</h4></li>
<li>先进先出</li>
<li>并不是很合理（例子：床头书柜）。<h4 id="2-近期最少使用算法（LRU）"><a href="#2-近期最少使用算法（LRU）" class="headerlink" title="2.近期最少使用算法（LRU）"></a>2.近期最少使用算法（LRU）</h4></li>
<li>最近时间段使用最少的或者（之后使用需要很长时间）替换出去<h4 id="3-随机淘汰算法（RAND）"><a href="#3-随机淘汰算法（RAND）" class="headerlink" title="3.随机淘汰算法（RAND）"></a>3.随机淘汰算法（RAND）</h4></li>
<li>随机选择一个用户页替换出<h4 id="4-最佳替换算法"><a href="#4-最佳替换算法" class="headerlink" title="4.最佳替换算法"></a>4.最佳替换算法</h4></li>
<li>替换到最晚到来的用户页<h3 id="小结"><a href="#小结" class="headerlink" title="*小结"></a>*小结</h3></li>
<li>直接映射：某一主存块只能映射到一个缓存块  <ul>
<li>cache利用率低，不灵活  </li>
</ul>
</li>
<li>全相联映射：某一主存块能映射到任意缓存块中  <ul>
<li>成本高，cache利用率低  </li>
</ul>
</li>
<li>组相联映射：某一主存块只能映射到某一缓存组中的任意一块<ul>
<li>全相连映射和直接映射的折中<h2 id="辅助存储器"><a href="#辅助存储器" class="headerlink" title="辅助存储器"></a>辅助存储器</h2><h3 id="1-概述"><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h3><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4></li>
</ul>
</li>
<li>不能直接和cpu交换信息<h4 id="磁表面储存器的技术指标"><a href="#磁表面储存器的技术指标" class="headerlink" title="磁表面储存器的技术指标"></a>磁表面储存器的技术指标</h4><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/71.png" alt=""><h3 id="2-磁记录原理和记录方式"><a href="#2-磁记录原理和记录方式" class="headerlink" title="2.磁记录原理和记录方式"></a>2.磁记录原理和记录方式</h3><h5 id="写"><a href="#写" class="headerlink" title="写"></a>写</h5>改变线圈电流方向转换磁极对磁载体进行磁化，写入0或者1<h5 id="读"><a href="#读" class="headerlink" title="读"></a>读</h5>磁层运动，磁通切割磁感线产生电流变化<h3 id="3-硬磁盘储存器"><a href="#3-硬磁盘储存器" class="headerlink" title="3.硬磁盘储存器"></a>3.硬磁盘储存器</h3><h4 id="1-类型"><a href="#1-类型" class="headerlink" title="1.类型"></a>1.类型</h4></li>
</ul>
<ol>
<li>固定磁头和移动磁头</li>
<li>可换盘和固定盘<h4 id="2-结构"><a href="#2-结构" class="headerlink" title="2.结构"></a>2.结构</h4>主机&lt;-&gt;磁盘控制器&lt;-&gt;磁盘驱动器&lt;-&gt;盘片<h3 id="4-软磁盘储存器"><a href="#4-软磁盘储存器" class="headerlink" title="4.软磁盘储存器"></a>4.软磁盘储存器</h3></li>
</ol>
<ul>
<li>硬盘速度高，软盘速度低</li>
<li>硬盘有固定、活动磁头，软盘只有活动磁头</li>
<li>硬盘磁头悬浮在硬盘表面，软盘与磁头接触</li>
<li>硬盘多为固定盘，盘组大部分不可更换，软盘可更换</li>
<li>硬盘价格高，软磁盘价格低</li>
<li>硬盘环境要求苛刻，软盘不是很苛刻<h3 id="5-光盘储存器"><a href="#5-光盘储存器" class="headerlink" title="5.光盘储存器"></a>5.光盘储存器</h3></li>
<li>采用光储存技术，利用激光读入写入<ul>
<li>第一代：非磁介质，不可擦写</li>
<li>第二代：磁介质，可擦写</li>
</ul>
</li>
<li>储存原理<ul>
<li>只读型（热作用，化学或者物理方法）</li>
<li>只写一次型（热作用，化学或者物理方法）</li>
<li>可擦可写（热磁效应）</li>
</ul>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/03/20/%E8%AE%A1%E7%BD%91%E7%AC%AC%E4%B8%80%E7%AB%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个不愿透露姓名的网友的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/03/20/%E8%AE%A1%E7%BD%91%E7%AC%AC%E4%B8%80%E7%AB%A0/" itemprop="url">计网第一章</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-03-20T17:10:48+08:00">
                2020-03-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><br><br><br><br><strong><em>互联网特点：连通性共享性</em></strong><br><strong><em>互联网具有虚拟的特点，无法具体知道对方是谁也无法知道具体的位置。</em></strong><br><br><br><br><br><br></p>
<h3 id="1-互联网形成"><a href="#1-互联网形成" class="headerlink" title="1.互联网形成"></a>1.互联网形成</h3><h4 id="第一阶段：单个网络APPANET-向互联网的发展过程"><a href="#第一阶段：单个网络APPANET-向互联网的发展过程" class="headerlink" title="第一阶段：单个网络APPANET 向互联网的发展过程"></a>第一阶段：单个网络APPANET 向互联网的发展过程</h4><ul>
<li>1983年 TCP/IP 协议成为 APPANET的标准协议，任何使用TCP/IP协议的计算机都可以使用互联网相互通信</li>
<li>因此人们把1983年当做互联网诞生的时间</li>
<li>1990 APPANET 关闭<br>互联网为专有名字与互连网不同<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/%E8%AE%A1%E7%BD%912.png" alt="不同"><h3 id="第二阶段：建成三级架构的互联网"><a href="#第二阶段：建成三级架构的互联网" class="headerlink" title="第二阶段：建成三级架构的互联网"></a>第二阶段：建成三级架构的互联网</h3></li>
<li>主干网</li>
<li>地区网</li>
<li>校园网（企业网）<br>第三阶段：逐渐形成 多层ISP结构互联网</li>
<li>ISP （Internet Service Provider）</li>
<li>任何机构和个人只要向ISP交纳规定费用，便可从ISP获取所需IP使用权，并将该ISP接入互联网。  </li>
<li>根据提供服务面积大小及IP数量多少，分为 1. 主干ISP 2.地区ISP 3.个人ISP<br><br><br><h3 id="成为互联网正式标准需要经过的阶段"><a href="#成为互联网正式标准需要经过的阶段" class="headerlink" title="成为互联网正式标准需要经过的阶段"></a>成为互联网正式标准需要经过的阶段</h3><strong><em>所有互联网标准都以RFC形式在互联网上发表</em></strong><h4 id="最开始需经过三个阶段"><a href="#最开始需经过三个阶段" class="headerlink" title="最开始需经过三个阶段"></a>最开始需经过三个阶段</h4></li>
<li>互联网草案——有效期只有六个月，此时还 <strong><em>不是</em></strong> RFC文档</li>
<li>建议标准——这个时期 <strong><em>开始成为</em></strong> RFC文档</li>
<li>互联网标准——达到正式标准后，每个标准会分配到一个标准号STDXXX。一个标准可以和多个RFC文档关联。  </li>
</ul>
<p><strong><em>现简化为两个过程：建议标准和花联网标准。</em></strong></p>
<p>除了建议标准和互联网标准两种RFC文档外，还有历史的、提供信息的、实验的RFC。<br>关系如下<br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/%E8%AE%A1%E7%BD%911.png" alt="关系图"></p>
<p><br><br><br><br>并从工作方式上康，互联网分为两个部分。</p>
<ul>
<li>互联网的边缘部分：由主机构成。这部分由用户直接使用，用来通信和资源共享。</li>
<li>互联网的核心部分：由大量的网络和连接这些网络的路由器组成。这部分是为了向边缘部分提供服务。（提供连通性和交换）<br><br><br>互联网边缘部分，也就是连接在互联网上的所有主机又称为 <strong><em>端系统</em></strong>。<br>主机在功能上可以有很大的差别。<br><br><br>主机A与主机B通信：运行在主机A上的一个程序与运行在主机B上的一个程序进行通信。<br><br><br>通信方式通常可以分为两大类</li>
<li>C/S  clien / server 客户对服务器通信。</li>
<li>P2P peer to peer对等通信。<h2 id="客户-服务器方式"><a href="#客户-服务器方式" class="headerlink" title="客户-服务器方式"></a>客户-服务器方式</h2>客户和服务器都是指通信过程中所涉及的两个应用进程。<br>客户-服务器是进程之间服务和被服务之间的关系。<br>客户是服务请求方，服务器是服务提供方</li>
</ul>
<h3 id="客户软件的特点："><a href="#客户软件的特点：" class="headerlink" title="客户软件的特点："></a>客户软件的特点：</h3><ul>
<li><strong>被用户调用后</strong> ,在打算通信前主动向远地服务器发起通信（发送请求）。<strong>因此要知道服务器程序的地址</strong></li>
<li>不需要特殊的硬件系统和很复杂的操作系统。<h3 id="服务器软件的特点："><a href="#服务器软件的特点：" class="headerlink" title="服务器软件的特点："></a>服务器软件的特点：</h3><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/%E8%AE%A1%E7%BD%91/%E8%AE%A1%E7%BD%913.png" alt=""><h4 id="p2p方式"><a href="#p2p方式" class="headerlink" title="p2p方式"></a>p2p方式</h4></li>
<li>没有服务方和被服务方的区别。</li>
<li>只要两个主机都下载了对等连接软件（p2p软件）就可以进行对等的、平等的通信。</li>
<li>双方都可以储存在对方硬盘里的 <strong>共享文档</strong>。<h4 id="对等连接的特点"><a href="#对等连接的特点" class="headerlink" title="对等连接的特点"></a>对等连接的特点</h4></li>
<li>本质上还是C/S 连接方式只是对等连接中的每一个主机既是服务器又是客户。</li>
<li>支持大量（上百万）对等用户同时工作。</li>
</ul>
<h4 id="互联网核心部分"><a href="#互联网核心部分" class="headerlink" title="互联网核心部分"></a>互联网核心部分</h4><ul>
<li>最复杂</li>
<li>向边缘部分提供连通性</li>
<li>起特殊作用的是路由器。路由器：实现分组交换的关键构建。作用是实现分组转发，这也是网络核心部分的 <strong>最重要功能</strong>。</li>
</ul>
<h3 id="交换"><a href="#交换" class="headerlink" title="交换"></a>交换</h3><p>1.电路交换<br>2.分组交换<br>3.报文交换<br>互联网核心部分采用了分组交换。</p>
<h4 id="电路交换"><a href="#电路交换" class="headerlink" title="电路交换"></a>电路交换</h4><p>N部电话机两两相连需要N<em>（N-1）/2,和交换机的数量的平方成正比。<br><em>*电话机很多是就要用交换机来完成连接全网的交换工作。采用的交换是电路交换。</em></em></p>
<p>交换：转换，从通信角度康，就是动态分配传输线路的资源。</p>
<h4 id="电路交换特点"><a href="#电路交换特点" class="headerlink" title="电路交换特点"></a>电路交换特点</h4><ul>
<li>面向连接</li>
<li>分为是三个阶段<ul>
<li>建立连接</li>
<li>通信</li>
<li>释放连接</li>
</ul>
</li>
<li>计算机数据具有突发性</li>
<li>线路利用率极低（传送数据的时间往往只不到10%甚至不到1%）<h4 id="分组交换特点"><a href="#分组交换特点" class="headerlink" title="分组交换特点"></a>分组交换特点</h4></li>
<li>采用储存转发技术</li>
<li>把较长的报文，划分为较短的、固定长度的报文</li>
<li>每一段数据前加上首部构成分组</li>
<li>以分组为基本单元在网络中传输<h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3></li>
<li>每一个分组的首部都有地址等信息。</li>
<li>每个分组在互联网中有独立的传输路径<h4 id="路由器"><a href="#路由器" class="headerlink" title="路由器"></a>路由器</h4></li>
<li>路由器输入与输出端口间没有直接连线。</li>
<li>处理分组过程<ul>
<li>把分组放到缓存区，暂时储存</li>
<li>查找转发表，找到某个目的地址应从哪个端口发出</li>
<li>把分组转到适当的端口发出</li>
</ul>
</li>
</ul>
<h4 id="分组转发好处"><a href="#分组转发好处" class="headerlink" title="分组转发好处"></a>分组转发好处</h4><ul>
<li>高效：动态分配传出宽带，对通信链路逐段占用</li>
<li>灵活：为每个分组寻找最适合转发路由</li>
<li>迅速：可不建立连接</li>
<li>可靠：保证可靠性的网络协议；分布式多路由的分组交换网，使网络有很好的生存性。</li>
</ul>
<h4 id="带来问题"><a href="#带来问题" class="headerlink" title="带来问题"></a>带来问题</h4><ul>
<li>必须排队，所以有时延</li>
<li>有首部，所以造成一定浪费</li>
</ul>
<h3 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h3><h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p>并未有很好的定义</p>
<p>计算机网络主要是由一些通用的、可编程的硬件互连而成的，而这些硬件并非专门用来实现某一特定目的（例如，传送数据或视频信号）。这些可编程的硬件能够用来传送多种不同类型的数据，并能支持广泛的和日益增长的应用</p>
<h4 id="区分"><a href="#区分" class="headerlink" title="区分"></a>区分</h4><p><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/%E8%AE%A1%E7%BD%91/%E8%AE%A1%E7%BD%914.png" alt=""><br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/%E8%AE%A1%E7%BD%91/%E8%AE%A1%E7%BD%915.png" alt=""><br><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/%E8%AE%A1%E7%BD%91/%E8%AE%A1%E7%BD%916.png" alt=""></p>
<p><br><br></p>
<h4 id="性能指标"><a href="#性能指标" class="headerlink" title="性能指标"></a>性能指标</h4><p>速率，带宽，吞吐率，时延，时延带宽积，往返时间RTT，利用率。</p>
<h4 id="带宽"><a href="#带宽" class="headerlink" title="带宽"></a>带宽</h4><p>在计算机网络中，带宽用来表示网络中某通道传送数据的能力。表示在单位时间内网络中的某信道所能通过的“最高数据率”。单位是 bit/s，即 “比特每秒”</p>
<p><strong>吞吐量受网络的带宽或网络的额定速率的限制</strong></p>
<p><strong>时延带宽积=传播时延*带宽</strong></p>
<h4 id="利用率"><a href="#利用率" class="headerlink" title="利用率"></a>利用率</h4><ul>
<li>信道利用率指出某信道有百分之几的时间是被利用的（有数据通过）。</li>
<li>完全空闲的信道的利用率是零。</li>
<li>网络利用率则是全网络的信道利用率的加权平均值。</li>
<li>信道利用率并非越高越好。当某信道的利用率增大时，该信道引起的时延也就迅速增加。</li>
</ul>
<p><strong>若令 D0 表示网络空闲时的时延，D 表示网络当前的时延，则在适当的假定条件下，可以用下面的简单公式表示 D 和 D0 之间的关系<br>D=D0/(1-U)</strong></p>
<p><strong>网络协议是计算机网络的不可缺少的组成部分</strong></p>
<p>TCP/IP</p>
<ul>
<li>应用层</li>
<li>运输层</li>
<li>网际层</li>
<li>网络接口层<br>五层协议</li>
<li>应用层</li>
<li>运输层</li>
<li>网络层</li>
<li>网络链路层</li>
<li>物理层</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/15/%E4%BA%8C%E5%88%86%E5%9B%BE&%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个不愿透露姓名的网友的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/15/%E4%BA%8C%E5%88%86%E5%9B%BE&%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95/" itemprop="url">二分图&匈牙利算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-10-15T22:13:03+08:00">
                2019-10-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>author:tc<br>勤劳的tc来了首先是二分图<br>他主要是有两个顶点集，然后顶点之间不能连接起来。？。。<br>怎么判断它是二分图？。。<br>先将一个一个点标记为1（或者0）然后与它连接起来的为标记的的就标记为0（或者1），如果该点已经标记，则判断他是否和顶点的值相同，相同则不为二分图，反之则是是。<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">bool is_two() &#123;</span><br><span class="line">	queue&lt;int&gt; que;</span><br><span class="line">	que.push(1);</span><br><span class="line">	int from;</span><br><span class="line">	visit[1]=1;</span><br><span class="line">	while(!que.empty()) &#123;</span><br><span class="line">		from=que.front();</span><br><span class="line">		que.pop();</span><br><span class="line">		int i=1;</span><br><span class="line">		for(i; i&lt;=n; i++) &#123;</span><br><span class="line">			if(map[from][i]) &#123;</span><br><span class="line">				if(!visit[i]) &#123;</span><br><span class="line">					que.push(i);</span><br><span class="line">					visit[i]=(visit[from]&amp;1)+1;</span><br><span class="line">				&#125; else if(visit[i]==visit[from]) &#123;</span><br><span class="line">					return false;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	return true;</span><br><span class="line">&#125;</span><br><span class="line">```  </span><br><span class="line">匈牙利算法主要是解决是二分图匹配问题。  </span><br><span class="line">一个顶点可以与多个结点相连。如果一个顶点只连接一个顶点求最多可以连接多少。  </span><br><span class="line">假如 a可以和c,d,e,f相连，h可以和c,d,m,n,  z可以和c,d,k相连。</span><br><span class="line">首先先匹配a和c。  </span><br><span class="line">第二步是匹配h，h不能喝c匹配，但是h并不想换人，所以就返回去看a能不能换a没办法只能换一个换到了d，h匹配到了c。最后就是z了，他也想匹配c，可是他也不想换，只能h换了，h换成了d可是d又和a匹配了，h也不想换之后a换了，a最后换成了e。最后a，h，z都匹配好了。  </span><br><span class="line">当然这个换人的过程是用递归实现的。  </span><br></pre></td></tr></table></figure></p>
<p>bool find(int x) {<br>    int j=1;<br>    for(; j&lt;=n; j++) {<br>        if(map[x][j]&amp;&amp;!visit[j]) {<br>            visit[j]=true;<br>            if(!match[j]||find(match[j])) {<br>                match[j]=x;<br>                return true;<br>            }<br>        }<br>    }<br>    return false;<br>}<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">以下是题目:  </span><br><span class="line">[hdu2444](http://acm.hdu.edu.cn/showproblem.php?pid=2444)   </span><br><span class="line">这道题先要判断是否为二分图，否的话输出-1  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">  </span><br><span class="line">  	   </span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h1 id="include"><a href="#include" class="headerlink" title="include"></a>include<iostream></h1><h1 id="include-1"><a href="#include-1" class="headerlink" title="include"></a>include<cstring></h1><h1 id="include-2"><a href="#include-2" class="headerlink" title="include"></a>include<queue></h1><p>using namespace std;</p>
<p>//bool find()</p>
<p>int map[205][205];</p>
<p>int match[205];<br>int visit[205];</p>
<p>int n,m;</p>
<p>bool find(int x) {<br>    int j=1;<br>    for(; j&lt;=n; j++) {<br>        if(map[x][j]&amp;&amp;!visit[j]) {<br>            visit[j]=true;<br>            if(!match[j]||find(match[j])) {<br>                match[j]=x;<br>                return true;<br>            }<br>        }<br>    }<br>    return false;<br>}</p>
<p>bool is_two() {<br>    queue<int> que;<br>    que.push(1);<br>    int from;<br>    visit[1]=1;<br>    while(!que.empty()) {<br>        from=que.front();<br>        que.pop();<br>        int i=1;<br>        for(i; i&lt;=n; i++) {<br>            if(map[from][i]) {<br>                if(!visit[i]) {<br>                    que.push(i);<br>                    visit[i]=(visit[from]&amp;1)+1;<br>                } else if(visit[i]==visit[from]) {<br>                    return false;<br>                }<br>            }<br>        }<br>    }<br>    return true;<br>}</p>
<p>int main() {<br>    cin.tie(NULL);<br>    cout.tie(NULL);<br>    ios::sync_with_stdio(false);<br>    while(cin&gt;&gt;n&gt;&gt;m) {<br>        memset(map,0,sizeof map);<br>        memset(match,0,sizeof match);<br>        memset(visit,0,sizeof visit);<br>        int i=0,one,two;<br>        for(; i<m; i++) {
            cin>&gt;one&gt;&gt;two;<br>            map[one][two]=1;<br>            map[two][one]=1;<br>        }<br>        int ans=0;<br>        if(!is_two()||n==1) {<br>            cout&lt;&lt;”No”&lt;&lt;endl;<br>            continue;<br>        }<br>        for(int i=1; i&lt;=n; i++) {<br>            memset(visit,0,sizeof visit);<br>            ans+=find(i);<br>        }<br>        cout&lt;&lt;ans/2&lt;&lt;endl;<br>    }<br>    return 0;<br>}<br>```</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/24/Untitled-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个不愿透露姓名的网友的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/24/Untitled-1/" itemprop="url">树形dp&&一些其他的很杂的东西</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-24T22:07:56+08:00">
                2019-09-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Oh，Oh勤劳的tc来了 。。<br>讲道理 很久没写了，也并不是很勤劳（小声bb）先是树形dp<br>就像他的名字这个dp是对像树一样的数据进行dp一般都是图，毕竟图你把每个点连起来就像树一样？！<br>说是dp其实我觉得像dfs+dp。<br>因为他的数据和树一样，所以普通的dp是完成不了的。首先他的一个节点上有很多个儿子结点，儿子节点上又有很多结点。所以这里用了dfs从他的叶子结点dp从他的叶子结点就开始判断最佳路径。<br>下面是题目<br><a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=1011">hdu 1011</a><br>首先他一个士兵可以打败20个怪兽意思，但是即使只有一个怪兽也要用1个士兵。所以这里判断士兵用量就是（bugs+19）/20 。然后dp的部分，先用一个数组二维的int型value[u][v]来记录他的路径。 u就是当前所在层数，然后v就是当前层数所有的士兵数，然后他是从后往前dp的所以他的dp转移方程就是<br>value[u][v]=max(value[u][v],value[u][v-j]+value[next][j]);这里的next就是和当前节点相连的一个节点然后他在第n层的最大brain获取量就是第u层留下v-j的brain获取量和next层花费j士兵是获取的brain量<br>code：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">#include&lt;unordered_map&gt;</span><br><span class="line">#include&lt;algorithm&gt;</span><br><span class="line">#include&lt;cmath&gt;</span><br><span class="line">#include&lt;queue&gt;</span><br><span class="line">#include&lt;cstring&gt;</span><br><span class="line">#include&lt;vector&gt;</span><br><span class="line">#define fastc cin.tie(NULL);</span><br><span class="line">#define fasto cout.tie(NULL);</span><br><span class="line">#define fasts ios::sync_with_stdio(false);</span><br><span class="line">#define END return 0;</span><br><span class="line">#include&lt;iomanip&gt;</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line">//char num[1000];</span><br><span class="line"></span><br><span class="line">int value[101][101];//记录值进行dp</span><br><span class="line">int visit[101];//看是否访问过，避免重复查找。</span><br><span class="line">int rec[101][101];//记录地图</span><br><span class="line">typedef pair&lt;int,int&gt; P;//储存bugs和brains</span><br><span class="line">P pa[101];</span><br><span class="line"></span><br><span class="line">int n,m;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">void dp(int u) &#123;</span><br><span class="line">	visit[u]=1;</span><br><span class="line">	int cost=(pa[u].first+19)/20;</span><br><span class="line">	for(int i=m; i&gt;=cost; i--) &#123;</span><br><span class="line">		value[u][i]=pa[u].second;//在第u层花费了cost个士兵都可以获得所有的brain</span><br><span class="line">	&#125;</span><br><span class="line">	for(int i=1; i&lt;=n; i++) &#123;</span><br><span class="line">		if(rec[u][i] &amp;&amp; !visit[i]) &#123;</span><br><span class="line">			dp(i);</span><br><span class="line">			for(int j=m; j&gt;=cost; j--) &#123;</span><br><span class="line">				int rest=j-cost;</span><br><span class="line">				for(int k=1; k&lt;=rest; k++) &#123;</span><br><span class="line">					value[u][j]=max(value[u][j],value[i][k]+value[u][j-k]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void prin() &#123;</span><br><span class="line">	for(int i=0; i&lt;=n; i++) &#123;</span><br><span class="line">		for(int j=0; j&lt;=m; j++) &#123;</span><br><span class="line">			cout&lt;&lt;value[i][j]&lt;&lt;&quot; &quot;;</span><br><span class="line">		&#125;</span><br><span class="line">	cout&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	//cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">	fastc fasto fasts</span><br><span class="line">	while(cin&gt;&gt;n&gt;&gt;m) &#123;</span><br><span class="line">		if(n==m&amp;&amp;n==-1) break;</span><br><span class="line">		memset(value,0,sizeof(value));</span><br><span class="line">		memset(visit,0,sizeof(visit));</span><br><span class="line">		memset(pa,0,sizeof(pa));</span><br><span class="line">		memset(rec,0,sizeof(rec));</span><br><span class="line">		int i=1;</span><br><span class="line">		for(i; i&lt;=n; i++) &#123;</span><br><span class="line">			cin&gt;&gt;pa[i].first&gt;&gt;pa[i].second;</span><br><span class="line">		&#125;</span><br><span class="line">		int one,two;</span><br><span class="line">		for(i=1; i&lt;n; i++) &#123;</span><br><span class="line">			cin&gt;&gt;one&gt;&gt;two;</span><br><span class="line">			rec[one][two]=1;</span><br><span class="line">			rec[two][one]=1;</span><br><span class="line">		&#125;</span><br><span class="line">		dp(1);</span><br><span class="line">		prin();</span><br><span class="line">		cout&lt;&lt;value[1][m]&lt;&lt;endl;</span><br><span class="line">	&#125;</span><br><span class="line">	END</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>题目：<br>dfs剪枝<br><a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=1010">hdu1010</a><br>这题是已经规定了步数<br>|0|1|0|1|0|1|<br>—|:—:|—:|—:|—:|—:|<br>|1|0|1|0|1|0|<br>|0|1|0|1|0|1|<br>|1|0|1|0|1|0|<br>|0|1|0|1|0|1|<br>|1|0|1|0|1|0|<br>|0|1|0|1|0|1|<br>|1|0|1|0|1|0|<br>|0|1|0|1|0|1|<br>|1|0|1|0|1|0|<br>|0|1|0|1|0|1|<br>可以知道从1走到0的步数一定是奇数<br>这里是最重要的一个剪枝，只有当起点的横纵坐标的奇偶性相同时，步数必须是奇数，反之则是偶数。<br>数论小知识<br>题目：<br><a target="_blank" rel="noopener" href="http://acm.hdu.edu.cn/showproblem.php?pid=1013">hdu1013</a><br>Digtial Roots=(sum-1)%9+1 </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/10/2019%E6%9A%91%E5%81%87%E7%AD%94%E8%BE%A9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个不愿透露姓名的网友的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/10/2019%E6%9A%91%E5%81%87%E7%AD%94%E8%BE%A9/" itemprop="url">吴天赐2019暑假答辩/周任务上传下载</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-09-10T21:44:21+08:00">
                2019-09-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>eeee,因为一些原因我这里只有后台。<br>主要的操作只有一些基础的增删改查，然后就是上传下载还有就是删除文件。<br>路径我是写在了yml中然后通过@ConfigurationProperties注解建立一个路径的properties的映射叫filePath，之后再使用路径。<br>api的接口是用swagger写的，但是我这里用的方法不对，不过swagger还是很好用的不过他要到几个依赖<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.5.0&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;io.springfox&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;2.5.0&lt;/version&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br></pre></td></tr></table></figure></p>
<p>还有就是这两个依赖的版本最好一样，不然会出现bug，接口文档通过注解，然后再通过浏览器获取网址<br>网址一般都是：<a target="_blank" rel="noopener" href="http://localhost:8080/swagger-ui.html">http://localhost:8080/swagger-ui.html</a><br>然后还可以在上面测试接口。<br>我这回用的是前后端分离，通过controller返回的是一个Result的模板类，其中有前端向后台请求的数据和返回的关于请求的信息。<br>上传的主要逻辑是先获取上传文件，然后判断是否是压缩文件，不是的话就返回用户他的文件信息，反之继续。文件的路径名用filePath中的路径当做母路径，母路径上再加上他的文件id、时间、一个随机数作为他的子路径。然后再用file.transferTo进行上传。之后再更新他的任务的信息，成员的信息，和提交信息。<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">package com.ctgu.upndo.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import com.ctgu.upndo.pojo.Member;</span><br><span class="line">import com.ctgu.upndo.pojo.Submit;</span><br><span class="line">import com.ctgu.upndo.pojo.Task;</span><br><span class="line">import com.ctgu.upndo.propeties.propeties;</span><br><span class="line">import com.ctgu.upndo.service.SaveAndFlushService;</span><br><span class="line">import com.ctgu.upndo.service.SearchService;</span><br><span class="line">import com.ctgu.upndo.utils.CodeEnum;</span><br><span class="line">import com.ctgu.upndo.utils.GetWayRan;</span><br><span class="line">import com.ctgu.upndo.utils.Result;</span><br><span class="line">import io.swagger.annotations.ApiImplicitParam;</span><br><span class="line">import io.swagger.annotations.ApiImplicitParams;</span><br><span class="line">import io.swagger.annotations.ApiOperation;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line">import org.springframework.web.bind.annotation.RestController;</span><br><span class="line">import org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line">import java.awt.print.Pageable;</span><br><span class="line">import java.io.File;</span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/upload&quot;)</span><br><span class="line">public class UploadController &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    propeties filepath;</span><br><span class="line">    @Autowired</span><br><span class="line">    SearchService searchService;</span><br><span class="line">    @Autowired</span><br><span class="line">    SaveAndFlushService saveAndFlushService;</span><br><span class="line">@ApiOperation(value=&quot;上传&quot;)</span><br><span class="line">@ApiImplicitParams(&#123;</span><br><span class="line">        @ApiImplicitParam(name=&quot;file&quot;,value=&quot;前端文件，只有一个&quot;),</span><br><span class="line">        @ApiImplicitParam(name=&quot;submit&quot;,value = &quot;提交详细Submit对象&quot;)</span><br><span class="line">&#125;)</span><br><span class="line">    @RequestMapping(&quot;/one&quot;)</span><br><span class="line">    public Result&lt;Integer&gt; upload( @RequestParam(&quot;file&quot;) MultipartFile file, @RequestParam(&quot;submit&quot;) Submit submit) &#123;</span><br><span class="line">        Result&lt;Integer&gt; res = new Result&lt;&gt;();</span><br><span class="line">        try &#123;</span><br><span class="line">            if (file.isEmpty()) &#123;</span><br><span class="line">                res.setResult(&quot;文件是空的啊..&quot;);</span><br><span class="line">                return res;</span><br><span class="line">            &#125;</span><br><span class="line">            String fileName = file.getOriginalFilename();</span><br><span class="line">            String suffixName = fileName.substring(fileName.lastIndexOf(&quot;.&quot;));</span><br><span class="line">            if (suffixName != &quot;zip&quot; &amp;&amp; suffixName!=&quot;rar&quot;) &#123;</span><br><span class="line">                res.setResult(&quot;30008&quot;,&quot;文件必须是zip和rar的啊,你的怎么是&quot; + suffixName + &quot;的啊&quot;);</span><br><span class="line">                return res;</span><br><span class="line">            &#125;</span><br><span class="line">            Result&lt;Member&gt; rm = searchService.findMemberByTidAndUid(submit.getTid(), submit.getSid());</span><br><span class="line">            if(rm.getData()==null)&#123;</span><br><span class="line">                res.setResult(CodeEnum.UPLOAD_ERROR);</span><br><span class="line">                return res;</span><br><span class="line">            &#125;</span><br><span class="line">            Member member=rm.getData();</span><br><span class="line">            Integer times = rm.getData().getTimes();</span><br><span class="line">            times++;</span><br><span class="line">            Integer ta = submit.getTid();</span><br><span class="line">            member.setTimes(times);</span><br><span class="line">            String ran= GetWayRan.getUpLoadRandom();</span><br><span class="line">            String path = filepath.getUpload_path()+ta.toString()+File.separator+ran+suffixName;</span><br><span class="line">            submit.setWay(path);</span><br><span class="line">            member.setLast(path);</span><br><span class="line">            File fi = new File(path);</span><br><span class="line">            if (!fi.getParentFile().exists()) &#123;</span><br><span class="line">                fi.getParentFile().mkdir();</span><br><span class="line">            &#125;</span><br><span class="line">            if (times == 1) &#123;</span><br><span class="line">                Result&lt;Task&gt; rt = searchService.findTaskByTid(submit.getTid());</span><br><span class="line">                Task task=rt.getData();</span><br><span class="line">                Integer number = task.getFinish();</span><br><span class="line">                number++;</span><br><span class="line">                task.setFinish(number);</span><br><span class="line">                saveAndFlushService.SaveAndFlushTask(task);</span><br><span class="line">            &#125;</span><br><span class="line">            file.transferTo(fi);</span><br><span class="line">            saveAndFlushService.SaveSubmit(submit);</span><br><span class="line">            saveAndFlushService.SaveAndFlushMember(member);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            res.setResult(CodeEnum.UPLOAD_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        res.setResult(CodeEnum.UPDATE_SUCCESS);</span><br><span class="line">        return res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>然后是下载，下载分为 两种学生下载，和管理员下载。学生下载需要前端传来判断信息。然后通过路径通过缓冲流进行下载。<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">package com.ctgu.upndo.controller;</span><br><span class="line"></span><br><span class="line">import com.ctgu.upndo.pojo.Submit;</span><br><span class="line">import com.ctgu.upndo.service.SearchService;</span><br><span class="line">import com.ctgu.upndo.utils.CodeEnum;</span><br><span class="line">import com.ctgu.upndo.utils.GetNumber;</span><br><span class="line">import com.ctgu.upndo.utils.Result;</span><br><span class="line">import com.ctgu.upndo.utils.ToNumber;</span><br><span class="line">import io.swagger.annotations.ApiImplicitParam;</span><br><span class="line">import io.swagger.annotations.ApiImplicitParams;</span><br><span class="line">import io.swagger.annotations.ApiOperation;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.stereotype.Controller;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line">import org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/download&quot;)</span><br><span class="line">public class DownloadController &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    SearchService searchService;</span><br><span class="line">@ApiOperation(value=&quot;下载&quot;)</span><br><span class="line">@ApiImplicitParam(name=&quot;list&quot;,value=&quot;String对象，下载项目序号&quot;)</span><br><span class="line">    @RequestMapping(value = &quot;student&quot;)</span><br><span class="line">    public Result&lt;Integer&gt; upload(HttpServletRequest request, HttpServletResponse response,@RequestParam(value = &quot;path&quot;) String path,@RequestParam(value = &quot;judge&quot;) String judge)&#123;</span><br><span class="line">        Result&lt;Integer&gt; res=new Result&lt;&gt;();</span><br><span class="line">        Integer flag= ToNumber.getNumber(judge);</span><br><span class="line">        if(flag==0)&#123;</span><br><span class="line">            res.setResult(&quot;30013&quot;,&quot;未在时限内，不可下载&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        res.setResult(CodeEnum.DOWNLOAD_SUCCESS);</span><br><span class="line">        String status=null;</span><br><span class="line">        String fileName=new String();</span><br><span class="line">        BufferedInputStream bis = null;</span><br><span class="line">        try&#123;</span><br><span class="line">            File file=new File(path);</span><br><span class="line">            if(!file.exists())&#123;</span><br><span class="line">                res.setResult(&quot;30012&quot;,&quot;文件为空&quot;);</span><br><span class="line">                return res;</span><br><span class="line">            &#125;</span><br><span class="line">            fileName=file.getName();</span><br><span class="line">            response.setContentType(&quot;application/force-download&quot;);// 设置强制下载不打开</span><br><span class="line">            response.addHeader(&quot;Content-Disposition&quot;, &quot;attachment;fileName=&quot; + fileName);// 设置文件名</span><br><span class="line">            byte[] buffer=new byte[1024];</span><br><span class="line">            bis=new BufferedInputStream(new FileInputStream(file));</span><br><span class="line">            OutputStream os=response.getOutputStream();</span><br><span class="line">            int number=bis.read(buffer);</span><br><span class="line">            while(number!=-1)&#123;</span><br><span class="line">                os.write(buffer,0,number);</span><br><span class="line">                number=bis.read(buffer);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;catch(Exception e)&#123;</span><br><span class="line">            res.setResult(CodeEnum.DOWNLOAD_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>管理员的复杂一点，前端传来字符串然后我进行处理得出他的需要下载的id。然后将文件打包成zip放在客户端上进行下载。<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">package com.ctgu.upndo.controller;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import com.ctgu.upndo.mapper.MemberMapper;</span><br><span class="line">import com.ctgu.upndo.mapper.TaskMapper;</span><br><span class="line">import com.ctgu.upndo.pojo.Member;</span><br><span class="line">import com.ctgu.upndo.pojo.Task;</span><br><span class="line">import com.ctgu.upndo.utils.CodeEnum;</span><br><span class="line">import com.ctgu.upndo.utils.GetNumber;</span><br><span class="line">import com.ctgu.upndo.utils.Result;</span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line">import java.io.*;</span><br><span class="line">import java.net.HttpURLConnection;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.zip.ZipEntry;</span><br><span class="line">import java.util.zip.ZipOutputStream;</span><br><span class="line"></span><br><span class="line">@RequestMapping(value = &quot;/downloads&quot;)</span><br><span class="line">public class Download &#123;</span><br><span class="line">    @Autowired</span><br><span class="line">    MemberMapper memberMapper;</span><br><span class="line">    @Autowired</span><br><span class="line">    TaskMapper taskMapper;</span><br><span class="line"></span><br><span class="line">    public Result&lt;Integer&gt; downloads(HttpServletResponse res, String list) throws IOException &#123;</span><br><span class="line">        Result&lt;Integer&gt; result = new Result&lt;&gt;();</span><br><span class="line">        List&lt;Integer&gt; numbers = GetNumber.getnumber(list);</span><br><span class="line">        int len = numbers.size();</span><br><span class="line">        List&lt;String&gt; filePaths = new ArrayList&lt;&gt;();</span><br><span class="line">        Member member = new Member();</span><br><span class="line">        //String way = new String();</span><br><span class="line">        for (int i = 0; i &lt; len; i++) &#123;</span><br><span class="line">            member = memberMapper.findMemberById(numbers.get(i));</span><br><span class="line">            filePaths.add(member.getLast());</span><br><span class="line">        &#125;</span><br><span class="line">        Task task = taskMapper.findTaskById(member.getTid());</span><br><span class="line">        String name = task.getTitle();</span><br><span class="line">        result.setResult(CodeEnum.SCCESS);</span><br><span class="line">        try &#123;</span><br><span class="line">            File file = new File(member.getLast());</span><br><span class="line">            String zipBasePath = file.getAbsolutePath();</span><br><span class="line">            String zipName = name + &quot;.zip&quot;;</span><br><span class="line">            String zipFilePath = zipBasePath + File.separator + zipName;</span><br><span class="line"></span><br><span class="line">            res.setCharacterEncoding(&quot;UTF-8&quot;); //设置编码字符</span><br><span class="line">            res.setContentType(&quot;application/force-download;charset=UTF-8&quot;); //设置下载内容类型</span><br><span class="line">            OutputStream out = res.getOutputStream();   //创建页面返回方式为输出流，会自动弹出下载框</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            File zip = new File(zipFilePath);</span><br><span class="line">            if (!zip.exists()) &#123;</span><br><span class="line">                zip.createNewFile();</span><br><span class="line">            &#125;</span><br><span class="line">            //创建zip文件输出流</span><br><span class="line">            ZipOutputStream zos = new ZipOutputStream(new FileOutputStream(zip));</span><br><span class="line">            this.zipFile(zipBasePath, zipName, zipFilePath, filePaths, zos);</span><br><span class="line">            zos.close();</span><br><span class="line">            res.setHeader(&quot;Content-disposition&quot;, &quot;attachment;filename=&quot; + zipName);//设置下载的压缩文件名称</span><br><span class="line"></span><br><span class="line">            //将打包后的文件写到客户端，输出的方法同上，使用缓冲流输出</span><br><span class="line">            BufferedInputStream bis = new BufferedInputStream(new FileInputStream(zipFilePath));</span><br><span class="line">            byte[] buff = new byte[bis.available()];</span><br><span class="line">            bis.read(buff);</span><br><span class="line">            bis.close();</span><br><span class="line">            out.write(buff);//输出数据文件</span><br><span class="line">            out.flush();//释放缓存</span><br><span class="line">            out.close();//关闭输出流</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            result.setResult(CodeEnum.DOWNLOAD_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private String zipFile(String zipBasePath, String zipName, String zipFilePath, List&lt;String&gt; filePaths, ZipOutputStream zos) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">        //循环读取文件路径集合，获取每一个文件的路径</span><br><span class="line">        for (String filePath : filePaths) &#123;</span><br><span class="line">            File inputFile = new File(filePath);  //根据文件路径创建文件</span><br><span class="line">            if (inputFile.exists()) &#123; //判断文件是否存在</span><br><span class="line"></span><br><span class="line">                    //创建输入流读取文件</span><br><span class="line">                    BufferedInputStream bis = new BufferedInputStream(new FileInputStream(inputFile));</span><br><span class="line"></span><br><span class="line">                    //将文件写入zip内，即将文件进行打包</span><br><span class="line">                    zos.putNextEntry(new ZipEntry(inputFile.getName()));</span><br><span class="line"></span><br><span class="line">                    //写入文件的方法</span><br><span class="line">                    int size = 0;</span><br><span class="line">                    byte[] buffer = new byte[1024];  //设置读取数据缓存大小</span><br><span class="line">                    while ((size = bis.read(buffer)) &gt; 0) &#123;</span><br><span class="line">                        zos.write(buffer, 0, size);</span><br><span class="line">                    &#125;</span><br><span class="line">                    //关闭输入输出流</span><br><span class="line">                    zos.closeEntry();</span><br><span class="line">                    bis.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>最后就是我的工具类，里面都是我对字符串的处理的一些类和我的Result类和CodeEnum。<br><img src="https://github.com/iamsnaping/picture/blob/master/utils.png?raw=true" alt="utils"><br>最后就是觉得自己对jpa了解了更多了吧。然后就是吸取了很多教训。虽然做的很不好不过感觉收获还是蛮大的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/07/26/Manacher%E2%80%98sAlgorithm/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个不愿透露姓名的网友的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/07/26/Manacher%E2%80%98sAlgorithm/" itemprop="url">马拉车算法 Manacher‘sAlgorithm  Author:tc</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-07-26T14:42:44+08:00">
                2019-07-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>勤劳的tc又来了这回是马拉车。讲道理我应该先学kmp的。算了kmp之后在学。马拉车算法是求最大回文串的。受用面很窄。<br>ok接下来就是algorithm time<br>第一步是先将原本的字符串初始化。将每个字符用一个符号包裹，一般是#。<br>在这个时候字符串无论如何就都是偶数了。有什么用呢，举个例子。我们从下标为1开始。<br>&nbsp;#1#2#2#1#<br>看这里中心位置是 一个#号然后他的下标是index=5，然后这个字符串的半径是r=5，然后原字符串就是 1221，可以看出这回字符串是从0（index-r） 开始 后四位（r-1）。这里是他最神奇的地方。也让他简便了很多。<br>我们一般字符串都是从下标0开始的所以我们在他前面加一个字符串里没有的字符一般,我取的是$。<br>当然这个算法不只这么一点。首先他有一个数组p[i],记录他每个位置的回文串的大小，然后又一个变量mx记录回文串可以到达的最右边下标，他还有个变量id记录该字符串的下标。<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">这里在开始匹配前记录回文串半径最小值。  </span><br><span class="line">当```mx&gt;i```</span><br><span class="line">很容易我们可以得到``` k=id*2-i```是i 关于id的对称点。而以id为中心</span><br><span class="line">mx-id为半径的字符串是对称的，所以当p[k]的边界在id的边界之内，以下标为i的字符串的半径为p[k]的字符串一定是回文串。而当p[k] 大于id的边界的时候就不能保证对称性了，所以这里就取mx-i。  </span><br><span class="line">当mx &lt; i 这里我们就不能确定对称性了，所以直接取1.</span><br><span class="line">以下是代码:</span><br></pre></td></tr></table></figure></p>
<h1 id="include"><a href="#include" class="headerlink" title="include"></a>include<iostream></h1><h1 id="include-1"><a href="#include-1" class="headerlink" title="include"></a>include<vector></h1><p>using namespace std;<br>string name,lo;<br>string lon(){<br>    lo=”$”;<br>    int i=0;<br>    while(name.size()&gt;i){<br>        lo+=”#”;<br>        lo+=name[i];<br>        i++;<br>    }<br>    lo+=”#”;<br>    int si=0,index=0;<br>    vector<int> p(lo.size(),0);<br>    i=0;<br>    int mx=0;<br>    int id=0;<br>    int len=lo.size();<br>    for(i;i<len;i++){
        p[i]= mx>i? min(p[id*2-i],mx-i):1;<br>        while(lo[i-p[i]]==lo[i+p[i]]) p[i]++;<br>        if(mx<i+p[i]){
            mx=i+p[i];
            id=i;
        }
        if(p[i]>si){<br>            index=i;<br>            si=p[i];<br>        }<br>    }<br>    cout&lt;&lt;name&lt;&lt;” “&lt;&lt;endl;<br>    return name.substr((index-si)/2,si-1);<br>}</p>
<p>int main(){<br>    name=”11123123312123311”;<br>    cout&lt;&lt;lon();<br>    return 0;<br>}<br>```</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/11/offsetof/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个不愿透露姓名的网友的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/11/offsetof/" itemprop="url">offsetof 宏定义</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-11T12:13:08+08:00">
                2019-06-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://raw.githubusercontent.com/iamsnaping/picture/master/%E9%A2%98%E7%9B%AE.png" alt="offsetof"></p>
<p>这里求得是结构体ST他的某一成员的的地址偏移量。就是MEMBER这个成员地址比他的结构体多了多少。<br>首先<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">int *p=(int *)0 ;</span><br><span class="line">cout&lt;&lt;p;   </span><br></pre></td></tr></table></figure><br>他的结果是0，他这里虽然有强制转换，但是赋值的时候他赋0，p的值就是0，不管怎么转换0就是0。<br>所以从内层开始，他这里将0的类型转换成了ST类型，然后取他的成员MEMBER，最后在外面取了地址，（size_t就相当于unsigned int）。<br>成员的地址相当于首地址+偏移量，这里他的首地址为0了，所以直接取的地址就是偏移量了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/03/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0%EF%BC%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="一个不愿透露姓名的网友的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/03/%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0%EF%BC%9F/" itemprop="url">求小于n与n互质的数（冇得证明）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-03T21:25:09+08:00">
                2019-06-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>数论真吉尔难啊啊啊！！！！！<br>这里就直接是公式了<br>小于n的质数的个数<br>设n=p<sup>k</sup>,m为小于n的质数的个数m=(p-1)<em>p<sup>k-1</sup>它们的和total=n </em> m/2;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/">&lt;</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">无敌 .2.0</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
